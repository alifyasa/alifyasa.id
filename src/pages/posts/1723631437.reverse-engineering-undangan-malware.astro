---
import Heading1 from "../../components/Heading1.astro";
import Heading2 from "../../components/Heading2.astro";
import Paragraph from "../../components/Paragraph.astro";
import Link from "../../components/Link.astro";
import OrderedList from "../../components/OrderedList.astro";
import ListItem from "../../components/ListItem.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
---

<BaseLayout title=`Reverse Engineering "Undangan Nikah" Malware`>
    <Heading1> Reverse Engineering "Undangan Nikah" Malware </Heading1>
    <Heading2> Summary </Heading2>
    <Paragraph>
        <OrderedList>
            <ListItem
                >The malware is an APK file called <code
                    >Lihat Poto Undangan_Pdf.apk</code
                > with package name <code>com.google.masitaux3</code>.</ListItem
            >
            <ListItem
                >Once installed, it does not appear in the launcher.</ListItem
            >
            <ListItem
                >Upon opening, the malware requests permissions to read
                notifications, read SMS messages, and send SMS messages.</ListItem
            >
            <ListItem
                >After obtaining these permissions, the app displays a blank
                screen.</ListItem
            >
            <ListItem
                >The malware monitors notifications and SMS messages, sending
                the captured data to its owner via the Telegram API and SMS.</ListItem
            >
            <ListItem
                >The data is sent to Telegram Bot <code>Deku1205</code> with the
                bot ID <code>6103323459</code> and phone number <code
                    >+6282141857614</code
                >.
            </ListItem>
            <ListItem
                >Its primary purpose seems to be the takeover of accounts
                secured with OTP codes sent via SMS or WhatsApp.</ListItem
            >
            <ListItem
                >Additionally, the malware can potentially generate money by
                taking over e-wallets, which often send verification codes
                through SMS or WhatsApp.</ListItem
            >
            <ListItem
                >This malware can be uninstalled from device settings.</ListItem
            >
        </OrderedList>
    </Paragraph>
    <Heading2> Important Links </Heading2>
    <Paragraph>
        Malware APK.
        <Link href="https://files.catbox.moe/5sem2y.apk"
            >https://files.catbox.moe/5sem2y.apk</Link
        >.
    </Paragraph>
    <Heading2> Background Story </Heading2>
    <Paragraph>
        My friend contacted me, saying that someone sent him a "virus". He wants
        me to look at it, so he sent me the "virus". It is an APK file named <code
            >Lihat Poto Undangan_Pdf.apk</code
        >.
    </Paragraph>
    <Heading2> Installing the APK </Heading2>
    <Paragraph>
        I installed it in android simulator. It didn't show up in my launcher,
        so I have to start the application from settings. First, it asked for
        two permissions:
        <OrderedList>
            <ListItem>Read notification.</ListItem>
            <ListItem>Read and send SMS.</ListItem>
        </OrderedList>
    </Paragraph>
    <Paragraph>
        After granting both, It displayed a blank screen.
    </Paragraph>
    <Heading2> Strings </Heading2>
    <Paragraph>
        I tried running the APK through <code>strings</code>. I got some
        interesting findings:
        <OrderedList>
            <ListItem
                >There are strings of multiple languages in the application.</ListItem
            >
            <ListItem
                >There is a string "Cek Resi", it seems like this app also use
                that name.</ListItem
            >
            <ListItem
                >The package name is <code>com.google.masitaux3</code
                >.</ListItem
            >
        </OrderedList>
    </Paragraph>
    <Paragraph>
        I didn't find anything else from <code>strings</code>, so I decompile
        it.
    </Paragraph>
    <Heading2>
        Decompilation using <code>apktools</code>
    </Heading2>
    <Paragraph>
        I encountered trouble decompiling the <code>res</code>, so I skipped it.
        I found some API calls to Telegram Bot API, which is called when the
        malware is installed and whenever a notification or SMS message is
        received. I also found a phone number in the APK.
    </Paragraph>
    <Heading2> Exploring Telegram Bot and Phone Number </Heading2>
    <Paragraph>
        In decompilation, I found two things:
        <OrderedList>
            <ListItem
                >A Telegram Bot API call to <code>sendMessage</code> when the malware
                is installed. The Bot ID is <code>6103323459</code> and the Bot username
                is <code>Deku1205</code>.</ListItem
            >
            <ListItem
                >A phone number in the APK. it is <code>+6282141857614</code>.
                in WhatsApp, the account name is <code>KING KEVIN</code>. I
                think this is just a burner phone number, as the name and
                profile picture belong to an instagram account called <Link
                    href="https://www.instagram.com/kingkevinreal/"
                    ><code>@kingkevinreal</code></Link
                >.</ListItem
            >
        </OrderedList>
    </Paragraph>
</BaseLayout>
